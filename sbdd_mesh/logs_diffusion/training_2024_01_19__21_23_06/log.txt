[2024-01-19 21:23:06,877::train::INFO] Namespace(act_fn='relu', batch_size=2, beta1=0.95, beta2=0.999, beta_end=0.002, beta_schedule='sigmoid', beta_start=1e-07, bond_loss_weight=1.0, center_pos_mode='protein', cutoff_mode='knn', data_name='pl', data_path='./data/crossdocked_v1.1_rmsd1.0_pocket10', data_split='/mnt/workspace/dlly/targetdiff_mesh/data/icml_new_data_split.pt', device='cuda:1', edge_feat_dim=4, ew_net_type='global', exp_name='test', factor=0.6, hidden_dim=128, knn=32, ligand_atom_mode='add_aromatic', logdir='./logs_diffusion', loss_mesh_weight=1, loss_v_weight=100.0, lr=0.0005, max_grad_norm=8.0, max_iters=500, min_lr=1e-06, model_mean_type='C0', model_type='uni_o2', n_acc_batch=2, n_heads=16, node_indicator=True, norm=True, num_blocks=1, num_diffusion_timesteps=1000, num_h2x=1, num_layers=9, num_node_types=8, num_r_gaussian=20, num_workers=2, num_x2h=1, optimizer_type='adam', patience=10, pos_noise_std=0.1, r_max=10.0, random_rot=False, sample_time_method='symmetric', scheduler_type='plateau', seed=2021, sync_twoup=False, tag='', time_emb_dim=0, time_emb_mode='simple', train_report_iter=200, v_beta_s=0.01, v_beta_schedule='cosine', val_freq=100, weight_decay=0.0, x2h_out_fc=False)
[2024-01-19 21:23:06,877::train::INFO] Loading dataset...
[2024-01-19 21:23:06,886::train::INFO] Training: 99948 Validation: 100
[2024-01-19 21:23:06,888::train::INFO] Building model...
[2024-01-19 21:23:08,021::train::INFO] # trainable parameters: 2.8247 M
[2024-01-19 21:23:12,774::train::INFO] [Train] Iter 1 | Loss 0.093940 (pos 0.025965 | v 0.001446 | mesh 0.017337) | Lr: 0.000500 | Grad Norm: 6.256424
[2024-01-19 21:23:13,729::train::INFO] [Train] Iter 2 | Loss 4.934909 (pos 6.676058 | v 0.003003 | mesh 2.893434) | Lr: 0.000500 | Grad Norm: 119.498550
[2024-01-19 21:23:14,417::train::INFO] [Train] Iter 3 | Loss 0.831553 (pos 0.692330 | v 0.003083 | mesh 0.662456) | Lr: 0.000500 | Grad Norm: 24.529648
[2024-01-19 21:23:14,866::train::INFO] [Train] Iter 4 | Loss 0.826806 (pos 1.505278 | v 0.000122 | mesh 0.136166) | Lr: 0.000500 | Grad Norm: 1.656073
[2024-01-19 21:23:15,625::train::INFO] [Train] Iter 5 | Loss 0.071816 (pos 0.038653 | v 0.000897 | mesh 0.015233) | Lr: 0.000500 | Grad Norm: 4.873711
[2024-01-19 21:23:16,088::train::INFO] [Train] Iter 6 | Loss 1.438792 (pos 2.333718 | v 0.002626 | mesh 0.281220) | Lr: 0.000500 | Grad Norm: 5.200939
[2024-01-19 21:23:16,731::train::INFO] [Train] Iter 7 | Loss 0.203647 (pos 0.090153 | v 0.003096 | mesh 0.007540) | Lr: 0.000500 | Grad Norm: 3.250200
[2024-01-19 21:23:17,433::train::INFO] [Train] Iter 8 | Loss 0.915795 (pos 1.653219 | v 0.001186 | mesh 0.059744) | Lr: 0.000500 | Grad Norm: 1.134818
[2024-01-19 21:23:19,116::train::INFO] [Train] Iter 9 | Loss 0.620496 (pos 1.074871 | v 0.001011 | mesh 0.065057) | Lr: 0.000500 | Grad Norm: 1.136580
[2024-01-19 21:23:19,930::train::INFO] [Train] Iter 10 | Loss 0.257792 (pos 0.283385 | v 0.000998 | mesh 0.132390) | Lr: 0.000500 | Grad Norm: 2.816288
[2024-01-19 21:23:20,381::train::INFO] [Train] Iter 11 | Loss 0.946016 (pos 1.582523 | v 0.001689 | mesh 0.140599) | Lr: 0.000500 | Grad Norm: 2.122852
[2024-01-19 21:23:21,026::train::INFO] [Train] Iter 12 | Loss 0.406162 (pos 0.543520 | v 0.001272 | mesh 0.141636) | Lr: 0.000500 | Grad Norm: 6.487612
[2024-01-19 21:23:21,453::train::INFO] [Train] Iter 13 | Loss 1.546449 (pos 2.831999 | v 0.001932 | mesh 0.067724) | Lr: 0.000500 | Grad Norm: 8.929502
[2024-01-19 21:23:22,075::train::INFO] [Train] Iter 14 | Loss 0.955986 (pos 1.690778 | v 0.001981 | mesh 0.023061) | Lr: 0.000500 | Grad Norm: 2.198806
[2024-01-19 21:23:22,872::train::INFO] [Train] Iter 15 | Loss 1.880377 (pos 3.320404 | v 0.002932 | mesh 0.147190) | Lr: 0.000500 | Grad Norm: 4.010925
[2024-01-19 21:23:23,554::train::INFO] [Train] Iter 16 | Loss 0.332606 (pos 0.489194 | v 0.001501 | mesh 0.025875) | Lr: 0.000500 | Grad Norm: 1.556953
[2024-01-19 21:23:24,201::train::INFO] [Train] Iter 17 | Loss 0.616916 (pos 1.038564 | v 0.001372 | mesh 0.058108) | Lr: 0.000500 | Grad Norm: 4.154909
[2024-01-19 21:23:24,944::train::INFO] [Train] Iter 18 | Loss 0.381346 (pos 0.617907 | v 0.001010 | mesh 0.043802) | Lr: 0.000500 | Grad Norm: 2.129539
[2024-01-19 21:23:25,373::train::INFO] [Train] Iter 19 | Loss 0.007601 (pos 0.007257 | v 0.000024 | mesh 0.005500) | Lr: 0.000500 | Grad Norm: 0.336857
[2024-01-19 21:23:26,039::train::INFO] [Train] Iter 20 | Loss 0.293137 (pos 0.332973 | v 0.002296 | mesh 0.023659) | Lr: 0.000500 | Grad Norm: 2.555987
[2024-01-19 21:23:26,723::train::INFO] [Train] Iter 21 | Loss 0.273079 (pos 0.219797 | v 0.003101 | mesh 0.016305) | Lr: 0.000500 | Grad Norm: 0.436951
[2024-01-19 21:23:27,157::train::INFO] [Train] Iter 22 | Loss 0.161060 (pos 0.237094 | v 0.000762 | mesh 0.008837) | Lr: 0.000500 | Grad Norm: 0.424782
[2024-01-19 21:23:27,597::train::INFO] [Train] Iter 23 | Loss 0.131403 (pos 0.079406 | v 0.001662 | mesh 0.017217) | Lr: 0.000500 | Grad Norm: 0.641652
[2024-01-19 21:23:28,706::train::INFO] [Train] Iter 24 | Loss 0.392813 (pos 0.659572 | v 0.000968 | mesh 0.029257) | Lr: 0.000500 | Grad Norm: 0.842323
[2024-01-19 21:23:29,127::train::INFO] [Train] Iter 25 | Loss 0.661621 (pos 1.140777 | v 0.001172 | mesh 0.065299) | Lr: 0.000500 | Grad Norm: 2.050397
[2024-01-19 21:23:29,824::train::INFO] [Train] Iter 26 | Loss 1.839154 (pos 3.424798 | v 0.001460 | mesh 0.107528) | Lr: 0.000500 | Grad Norm: 1.319415
[2024-01-19 21:23:30,264::train::INFO] [Train] Iter 27 | Loss 0.481838 (pos 0.613018 | v 0.003074 | mesh 0.043259) | Lr: 0.000500 | Grad Norm: 1.588240
[2024-01-19 21:23:31,066::train::INFO] [Train] Iter 28 | Loss 0.471271 (pos 0.755801 | v 0.001318 | mesh 0.054932) | Lr: 0.000500 | Grad Norm: 3.253561
[2024-01-19 21:23:31,460::train::INFO] [Train] Iter 29 | Loss 0.198122 (pos 0.227229 | v 0.001105 | mesh 0.058484) | Lr: 0.000500 | Grad Norm: 2.457720
[2024-01-19 21:23:31,892::train::INFO] [Train] Iter 30 | Loss 0.795662 (pos 1.390581 | v 0.001567 | mesh 0.044085) | Lr: 0.000500 | Grad Norm: 5.034354
[2024-01-19 21:23:32,630::train::INFO] [Train] Iter 31 | Loss 0.524876 (pos 0.874404 | v 0.001225 | mesh 0.052808) | Lr: 0.000500 | Grad Norm: 1.294001
[2024-01-19 21:23:33,056::train::INFO] [Train] Iter 32 | Loss 0.203208 (pos 0.278091 | v 0.000987 | mesh 0.029657) | Lr: 0.000500 | Grad Norm: 1.970074
[2024-01-19 21:23:33,519::train::INFO] [Train] Iter 33 | Loss 0.103762 (pos 0.112365 | v 0.000755 | mesh 0.019620) | Lr: 0.000500 | Grad Norm: 0.769212
[2024-01-19 21:23:34,169::train::INFO] [Train] Iter 34 | Loss 0.449342 (pos 0.796539 | v 0.000790 | mesh 0.023122) | Lr: 0.000500 | Grad Norm: 0.194235
[2024-01-19 21:23:34,622::train::INFO] [Train] Iter 35 | Loss 1.136738 (pos 2.054682 | v 0.001522 | mesh 0.066634) | Lr: 0.000500 | Grad Norm: 1.952191
[2024-01-19 21:23:35,046::train::INFO] [Train] Iter 36 | Loss 1.097158 (pos 1.839626 | v 0.002593 | mesh 0.095396) | Lr: 0.000500 | Grad Norm: 0.587514
[2024-01-19 21:23:35,472::train::INFO] [Train] Iter 37 | Loss 0.109842 (pos 0.110042 | v 0.001011 | mesh 0.008538) | Lr: 0.000500 | Grad Norm: 0.448668
[2024-01-19 21:23:36,560::train::INFO] [Train] Iter 38 | Loss 1.445375 (pos 2.709374 | v 0.000448 | mesh 0.136597) | Lr: 0.000500 | Grad Norm: 1.843410
[2024-01-19 21:23:36,984::train::INFO] [Train] Iter 39 | Loss 0.501964 (pos 0.792514 | v 0.001078 | mesh 0.103621) | Lr: 0.000500 | Grad Norm: 3.920179
[2024-01-19 21:23:37,623::train::INFO] [Train] Iter 40 | Loss 2.255542 (pos 4.215133 | v 0.001629 | mesh 0.133030) | Lr: 0.000500 | Grad Norm: 2.560347
[2024-01-19 21:23:38,070::train::INFO] [Train] Iter 41 | Loss 0.251598 (pos 0.321164 | v 0.001726 | mesh 0.009472) | Lr: 0.000500 | Grad Norm: 0.911333
[2024-01-19 21:23:38,524::train::INFO] [Train] Iter 42 | Loss 1.946991 (pos 3.573489 | v 0.001758 | mesh 0.144659) | Lr: 0.000500 | Grad Norm: 3.235436
[2024-01-19 21:23:39,205::train::INFO] [Train] Iter 43 | Loss 0.202563 (pos 0.135030 | v 0.002547 | mesh 0.015432) | Lr: 0.000500 | Grad Norm: 0.593372
[2024-01-19 21:23:39,628::train::INFO] [Train] Iter 44 | Loss 0.245662 (pos 0.096231 | v 0.003795 | mesh 0.015631) | Lr: 0.000500 | Grad Norm: 1.245768
[2024-01-19 21:23:40,312::train::INFO] [Train] Iter 45 | Loss 0.181306 (pos 0.233820 | v 0.001139 | mesh 0.014882) | Lr: 0.000500 | Grad Norm: 1.819932
[2024-01-19 21:23:40,754::train::INFO] [Train] Iter 46 | Loss 0.143854 (pos 0.114976 | v 0.001479 | mesh 0.024856) | Lr: 0.000500 | Grad Norm: 0.995178
[2024-01-19 21:23:41,613::train::INFO] [Train] Iter 47 | Loss 0.175225 (pos 0.128196 | v 0.002001 | mesh 0.022121) | Lr: 0.000500 | Grad Norm: 0.935271
[2024-01-19 21:23:42,041::train::INFO] [Train] Iter 48 | Loss 0.314772 (pos 0.450955 | v 0.001460 | mesh 0.032622) | Lr: 0.000500 | Grad Norm: 1.332027
[2024-01-19 21:23:42,701::train::INFO] [Train] Iter 49 | Loss 0.692451 (pos 1.225215 | v 0.001108 | mesh 0.048882) | Lr: 0.000500 | Grad Norm: 0.636758
[2024-01-19 21:23:43,121::train::INFO] [Train] Iter 50 | Loss 0.484716 (pos 0.632905 | v 0.002477 | mesh 0.088835) | Lr: 0.000500 | Grad Norm: 0.792707
[2024-01-19 21:23:43,522::train::INFO] [Train] Iter 51 | Loss 2.926984 (pos 5.608097 | v 0.001489 | mesh 0.096973) | Lr: 0.000500 | Grad Norm: 2.620815
[2024-01-19 21:23:43,945::train::INFO] [Train] Iter 52 | Loss 0.576493 (pos 0.910904 | v 0.002016 | mesh 0.040480) | Lr: 0.000500 | Grad Norm: 3.596869
[2024-01-19 21:23:44,689::train::INFO] [Train] Iter 53 | Loss 1.275688 (pos 2.320524 | v 0.001321 | mesh 0.098795) | Lr: 0.000500 | Grad Norm: 0.680852
[2024-01-19 21:23:45,458::train::INFO] [Train] Iter 54 | Loss 0.296730 (pos 0.343043 | v 0.001840 | mesh 0.066399) | Lr: 0.000500 | Grad Norm: 2.535369
[2024-01-19 21:23:46,072::train::INFO] [Train] Iter 55 | Loss 0.956078 (pos 1.628143 | v 0.002001 | mesh 0.083904) | Lr: 0.000500 | Grad Norm: 0.455195
[2024-01-19 21:23:46,901::train::INFO] [Train] Iter 56 | Loss 1.349075 (pos 2.462678 | v 0.001121 | mesh 0.123362) | Lr: 0.000500 | Grad Norm: 0.525900
[2024-01-19 21:23:47,627::train::INFO] [Train] Iter 57 | Loss 1.844586 (pos 3.399060 | v 0.001939 | mesh 0.096168) | Lr: 0.000500 | Grad Norm: 1.748072
[2024-01-19 21:23:48,042::train::INFO] [Train] Iter 58 | Loss 0.573579 (pos 0.922043 | v 0.001510 | mesh 0.074090) | Lr: 0.000500 | Grad Norm: 6.441794
[2024-01-19 21:23:48,450::train::INFO] [Train] Iter 59 | Loss 0.692286 (pos 1.106496 | v 0.001812 | mesh 0.096859) | Lr: 0.000500 | Grad Norm: 1.235674
[2024-01-19 21:23:48,866::train::INFO] [Train] Iter 60 | Loss 0.112179 (pos 0.178903 | v 0.000037 | mesh 0.041799) | Lr: 0.000500 | Grad Norm: 2.720750
[2024-01-19 21:23:49,278::train::INFO] [Train] Iter 61 | Loss 0.303309 (pos 0.379517 | v 0.001833 | mesh 0.043781) | Lr: 0.000500 | Grad Norm: 1.409473
[2024-01-19 21:23:50,023::train::INFO] [Train] Iter 62 | Loss 1.572334 (pos 2.879668 | v 0.001476 | mesh 0.117446) | Lr: 0.000500 | Grad Norm: 0.779608
[2024-01-19 21:23:50,422::train::INFO] [Train] Iter 63 | Loss 0.279431 (pos 0.366258 | v 0.001497 | mesh 0.042939) | Lr: 0.000500 | Grad Norm: 1.669174
[2024-01-19 21:23:50,863::train::INFO] [Train] Iter 64 | Loss 0.214125 (pos 0.219090 | v 0.001733 | mesh 0.035855) | Lr: 0.000500 | Grad Norm: 0.520713
[2024-01-19 21:23:51,249::train::INFO] [Train] Iter 65 | Loss 0.229762 (pos 0.167602 | v 0.002616 | mesh 0.030352) | Lr: 0.000500 | Grad Norm: 0.633598
[2024-01-19 21:23:51,889::train::INFO] [Train] Iter 66 | Loss 0.616909 (pos 0.906525 | v 0.002673 | mesh 0.059993) | Lr: 0.000500 | Grad Norm: 1.253774
[2024-01-19 21:23:52,325::train::INFO] [Train] Iter 67 | Loss 0.124273 (pos 0.106554 | v 0.001080 | mesh 0.034027) | Lr: 0.000500 | Grad Norm: 0.391979
[2024-01-19 21:23:52,757::train::INFO] [Train] Iter 68 | Loss 0.793575 (pos 1.345294 | v 0.001373 | mesh 0.104579) | Lr: 0.000500 | Grad Norm: 1.119139
[2024-01-19 21:23:53,489::train::INFO] [Train] Iter 69 | Loss 0.048422 (pos 0.026846 | v 0.000443 | mesh 0.025664) | Lr: 0.000500 | Grad Norm: 0.475396
[2024-01-19 21:23:54,231::train::INFO] [Train] Iter 70 | Loss 0.138877 (pos 0.095471 | v 0.001462 | mesh 0.036074) | Lr: 0.000500 | Grad Norm: 0.465418
[2024-01-19 21:23:55,013::train::INFO] [Train] Iter 71 | Loss 0.975071 (pos 1.633652 | v 0.002404 | mesh 0.076125) | Lr: 0.000500 | Grad Norm: 0.898832
[2024-01-19 21:23:55,825::train::INFO] [Train] Iter 72 | Loss 0.955258 (pos 1.654214 | v 0.001543 | mesh 0.101979) | Lr: 0.000500 | Grad Norm: 2.026683
[2024-01-19 21:23:56,470::train::INFO] [Train] Iter 73 | Loss 0.639985 (pos 0.975177 | v 0.002465 | mesh 0.058243) | Lr: 0.000500 | Grad Norm: 0.343862
[2024-01-19 21:23:56,902::train::INFO] [Train] Iter 74 | Loss 0.353709 (pos 0.462366 | v 0.002086 | mesh 0.036430) | Lr: 0.000500 | Grad Norm: 0.581433
[2024-01-19 21:23:57,497::train::INFO] [Train] Iter 75 | Loss 0.769675 (pos 1.307398 | v 0.001631 | mesh 0.068857) | Lr: 0.000500 | Grad Norm: 1.134224
[2024-01-19 21:23:57,917::train::INFO] [Train] Iter 76 | Loss 1.455276 (pos 2.706003 | v 0.001095 | mesh 0.095021) | Lr: 0.000500 | Grad Norm: 0.751166
[2024-01-19 21:23:58,335::train::INFO] [Train] Iter 77 | Loss 0.495153 (pos 0.765030 | v 0.001675 | mesh 0.057757) | Lr: 0.000500 | Grad Norm: 1.547923
[2024-01-19 21:23:59,135::train::INFO] [Train] Iter 78 | Loss 1.657462 (pos 2.989109 | v 0.002201 | mesh 0.105680) | Lr: 0.000500 | Grad Norm: 1.565583
[2024-01-19 21:23:59,778::train::INFO] [Train] Iter 79 | Loss 0.244987 (pos 0.271746 | v 0.001825 | mesh 0.035685) | Lr: 0.000500 | Grad Norm: 0.631825
[2024-01-19 21:24:00,236::train::INFO] [Train] Iter 80 | Loss 0.119868 (pos 0.117688 | v 0.000857 | mesh 0.036382) | Lr: 0.000500 | Grad Norm: 0.480601
[2024-01-19 21:24:00,881::train::INFO] [Train] Iter 81 | Loss 0.491374 (pos 0.806873 | v 0.001253 | mesh 0.050552) | Lr: 0.000500 | Grad Norm: 1.135590
[2024-01-19 21:24:01,503::train::INFO] [Train] Iter 82 | Loss 0.313493 (pos 0.283071 | v 0.002897 | mesh 0.054207) | Lr: 0.000500 | Grad Norm: 1.323691
[2024-01-19 21:24:01,938::train::INFO] [Train] Iter 83 | Loss 0.529024 (pos 0.885821 | v 0.001027 | mesh 0.069510) | Lr: 0.000500 | Grad Norm: 0.611108
[2024-01-19 21:24:02,367::train::INFO] [Train] Iter 84 | Loss 0.512685 (pos 0.706419 | v 0.002562 | mesh 0.062740) | Lr: 0.000500 | Grad Norm: 1.303032
[2024-01-19 21:24:03,024::train::INFO] [Train] Iter 85 | Loss 0.833194 (pos 1.339563 | v 0.002267 | mesh 0.100128) | Lr: 0.000500 | Grad Norm: 3.040999
[2024-01-19 21:24:03,667::train::INFO] [Train] Iter 86 | Loss 0.270049 (pos 0.393468 | v 0.001081 | mesh 0.038510) | Lr: 0.000500 | Grad Norm: 1.178359
[2024-01-19 21:24:04,295::train::INFO] [Train] Iter 87 | Loss 0.573467 (pos 0.619367 | v 0.004278 | mesh 0.099793) | Lr: 0.000500 | Grad Norm: 1.509276
